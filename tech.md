# Technical Documentation

_**under construction**_

## Overview

This document provides technical insights into the Android application developed
using Android Studio and Java. The application targets devices running Android 7
Nougat and higher. It offers user registration and login through both email-password 
credentials and Google Sign-In provided by [Firebase Auth](#authentication)

The app provides private-public key management and generation using the Falcon PQC scheme.
Users can upload documents and sign them with their keys and public key can be shared via QR
code for easier verification. Other option is to create a "room" with other users and generate
multiparty signature keys using PQC keys and store them for later use. The aim is to decentralize
multiparty signature generation such that no party can retrieve information about single private keys
or create valid signature without all members of the "room". Security will be enhanced by 
the use of user biometrics.

***

### Table of Contents
1. [Application Usage](#application-usage)
2. [Security](#security)
3. [Authentication](#authentication)

    3.1 [Registration](#registration)

    3.2 [Google sign in](#google-sign-in)

    3.3 [email-password](#email-password)
 
4. [Databases](#databases)

    4.1 [Database diagrams](#database-diagrams)
    
    4.2 [Database security](#database-security)
5. [Key Management](#key-management)
6. [Multiparty Signature](#multiparty-signature-scheme)
7. [Biometric Usage](#biometric-authentication)
8. [Firebase Backend](#firebase-backend)
9. [References](#references)

***

## Theme
This application uses Material theme UI for android [[1]](#references).

---

<div align="center">
    <img src = "img/primary.png" alt="primary" width="96"> 
    <img src = "img/secondary.png" alt="Secondary" width="96">
    <img src = "img/tertiary.png" alt="Tertiary" width="96">
    <img src = "img/netral.png" alt="Neutral" width="96">
</div>

<div align="center">

<span style="color:#0039A6; padding: 20px">
#0039A6
</span>
<span style="color:#3858B7; padding: 20px">
#3858B7
</span>
<span style="color:#aa86a4; padding: 20px">
#aa86a4
</span>
<span style="color:#919094; padding: 20px">
#919094
</span>

</div>

For UI guide refer to [User/UI documentation](user.md).

---

## Application usage

## Security

## Authentication
*all password fields provide visibility toggle option

The application provides two authentication options:

- **Email-Password Credentials:** Users can register and log in using their email and password.
- **Google Sign-In:** Users have the option to log in using their Google accounts.
  
(Note that there is an option to add more commercial authentication methods)

Both options are provided by Firebase authentication feature which includes user database and management. On top of
provided authentication the application implements custom user management such that each user upon registration is assigned
personal autogenerated id (#exaMple123) and storage space in [Firebase Firestore database](#databases). This implementation 
provides more user account control.

### Registration
For application use, the user is prompted to register. User can register with custom email or with google sign in option.
If the email provided is already in use (has to be unique), user is informed that email is already in use. This feature is 
implemented by querying the database for provided email, for further information please see [database](#databases).

### Email-password
This option is operated by Firebase Authentication, the user will input their email and password. With this option there is an
option to reset password.

**Email** : input field is checked for email format

**Password** : password is checked for length (6-12 characters) and strength (at least one number and uppercase and lowercase letter)

**Password repeat** : this field is locked until the password meets all requirements and if the password field is changed
so that password breaks the requirements, field locks again

In the real time user can see warning messages according to requirements.

**Forgotten password** : after filling the reset password prompt, application will send an email form to reset password. 
This feature is handled by Firebase backend. The user is then displayed either _"We have send you an email"_ or error message
according to reset result.


### Google sign-in
Third party option to register and sign in provided by Firebase authentication. Upon registration the user can choose an option
to sign in via google account, this process is handled purely by Google Signin Client, apart from extra database features which 
are handled by custom implementation

This sign in option does not provide _Forgotten password_ feature as the application only receives unique token from sign in client.


**After succesful registration/sign in, user is redirected to homepage. See [User/UI guide](user.md)**

## Databases

### Database diagrams
### Database security

## Key Management

Once registered and authenticated, users can manage private-public key pairs generated using the Falcon PQC scheme.
This allows for secure document signing and key sharing. The key management feature include:

- **Key Generation:** Users can generate private-public key pairs using the Falcon PQC scheme.
- **Document Signing:** Users can sign documents using their private keys.
- **Key Sharing:** Users can share their public keys via QR codes for easy verification.

The keys are securely transferred and stored in each user personal database such that only owner of the key can access it
(Further described in [database security](#database-security)).


### Multiparty Signature Scheme



## Biometric Authentication

For enhanced security, the application offers biometric authentication methods:

- **Fingerprint Authentication:** Users can use their fingerprints to ==TODO==
- **Other Biometric Methods:** maybe ... 

## Firebase Backend

The backend of the application is managed by Google Firebase services. This application uses:

- **User Authentication Management:** Firebase handles user registration and authentication securely.
- **Firestore Database:** The Firestore database is used to store user data and key-related information.
- **App Check:** To ensure the connection to firestore server is only from registered application.


## References
 [1] https://m3.material.io/theme-builder#/custom
 [2] https://firebase.google.com/



